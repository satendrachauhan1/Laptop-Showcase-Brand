<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Global Laptop Brand Showcase</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .item-count {
      background: #ff6b35;
      color: #fff;
      padding: 2px 6px;
      border-radius: 12px;
      margin-left: 8px;
      font-weight: 700;
      font-size: 0.9rem;
    }

    .card-footer {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 10px;
    }

    .dec-btn {
      display: none;
    }

    /* User profile popup styles */
    #userProfileBtn {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 24px;
      padding: 4px;
      border-radius: 50%;
      transition: background-color 0.3s ease;
    }

    #userProfileBtn:hover {
      background-color: wheat;
    }

    #userPopup {
      display: none;
      position: absolute;
      right: 0;
      top: 56px; /* moved down for better spacing under profile button */
      background: #fff;
      box-shadow: 0 8px 22px rgba(0, 0, 0, 0.15);
      border-radius: 10px;
      padding: 12px 20px;
      width: 220px;
      font-family: Inter, sans-serif;
      font-size: 0.95rem;
      color: #222;
      z-index: 1000;
      transition: opacity 160ms ease, transform 160ms ease;
      transform-origin: top right;
    }

    #userPopup button {
      background: #1976d2;
      border: none;
      color: #fff;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      width: 100%;
      transition: background-color 0.3s ease;
    }

    #userPopup button:disabled {
      background-color: #aaa;
      cursor: default;
    }

    #userPopup button:hover:not(:disabled) {
      background-color: #135aab;
    }

    /* Logout button (red theme) */
    #userPopup #logoutBtn {
      background: #d32f2f;
      border: none;
      color: #fff;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      width: 100%;
      margin-top: 8px;
      transition: background-color 0.3s ease;
    }

    #userPopup #logoutBtn:disabled {
      background-color: #aaa;
      cursor: default;
    }

    #userPopup #logoutBtn:hover:not(:disabled) {
      background-color: #b71c1c;
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 12px;
    }

    header > div:first-child {
      flex-grow: 1;
      min-width: 200px;
    }

    header > div:last-child {
      display: flex;
      align-items: center;
      gap: 16px;
      position: relative;
      min-width: 120px;
      justify-content: flex-end;
    }

    /* Override absolute cart styles and make header buttons responsive */
    .cart-btn {
      position: static;
      background-color: #ff9f00;
      color: #fff;
      border: none;
      padding: 10px 14px;
      border-radius: 8px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-weight: 700;
      box-shadow: 0 6px 18px rgba(0,0,0,0.08);
    }

    .cart-btn:hover { background-color: #fb641b; }

    /* style the small count bubble inside cart button */
    .cart-btn #cartCount {
      background: #ff6b35;
      color: #fff;
      padding: 2px 8px;
      border-radius: 12px;
      margin-left: 8px;
      font-weight: 700;
    }

    #userProfileBtn {
      background: transparent;
      border: none;
      color: #fff;
      background-color: white;
      font-size: 20px;
      padding: 6px;
      border-radius: 50%;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      header {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
        padding: 14px 18px;
      }

      header > div:first-child { width: 100%; }

      header > div:last-child {
        width: 100%;
        justify-content: flex-end;
        gap: 10px;
      }

      .search-box input { width: 90%; }
    }
  </style>
</head>

<body>
  <header>
    <div>
      <h1>üåç Global Laptop Brand Showcase</h1>
      <p>Explore laptop brands used all over the world</p>
    </div>

    <div>
      <button class="cart-btn" onclick="window.location.href='cart.html'">
        üõí Cart
        <span
          id="cartCount"
          style="background:#ff6b35;color:#fff;padding:2px 8px;border-radius:12px;margin-left:8px;font-weight:700;"
          >0</span
        >
      </button>

      <button id="userProfileBtn" aria-label="User Profile">üë§</button>

      <div id="userPopup" role="dialog" aria-modal="true" aria-labelledby="userName">
        <div id="userName" style="font-weight:700; font-size:1.1rem; color:#1976d2; margin-bottom:6px;">User
          Name</div>
        <div id="userEmail" style="color:#555; margin-bottom:12px;">user@example.com</div>
        <button id="ordersPageBtn">View Orders</button>
        <button id="logoutBtn">Logout</button>
      </div>
    </div>
  </header>

  <!-- Search -->
  <div class="search-box">
    <input
      type="text"
      id="searchInput"
      placeholder="Search laptop brand..."
      onkeyup="searchBrand()"
    />
  </div>

  <section class="brand-section">
    <div class="brand-container">
      <!-- Apple -->
      <div class="brand-card">
        <img src="images/apple.jpg" />
        <h3>Apple</h3>
        <p>MacBook Air & Pro</p>
        <h4>‚Çπ90,000 ‚Äì ‚Çπ2,50,000</h4>
        <div class="card-footer">
          <button onclick="addToCart('Apple', 120000)">+</button>
          <button
            class="dec-btn"
            data-brand="Apple"
            onclick="changeQuantity('Apple', -1)"
            style="min-width:34px"
            >-</button
          >
          <span class="item-count" data-brand="Apple">0</span>
        </div>
      </div>

      <!-- Dell -->
      <div class="brand-card">
        <img src="images/dell.jpg" />
        <h3>Dell</h3>
        <p>Inspiron, XPS, Alienware</p>
        <h4>‚Çπ45,000 ‚Äì ‚Çπ2,20,000</h4>
        <div class="card-footer">
          <button onclick="addToCart('Dell', 60000)">+</button>
          <button
            class="dec-btn"
            data-brand="Dell"
            onclick="changeQuantity('Dell', -1)"
            style="min-width:34px"
            >-</button
          >
          <span class="item-count" data-brand="Dell">0</span>
        </div>
      </div>

      <!-- HP -->
      <div class="brand-card">
        <img src="images/hp.jpg" />
        <h3>HP</h3>
        <p>Pavilion, Victus, Omen</p>
        <h4>‚Çπ40,000 ‚Äì ‚Çπ2,00,000</h4>
        <div class="card-footer">
          <button onclick="addToCart('HP', 55000)">+</button>
          <button
            class="dec-btn"
            data-brand="HP"
            onclick="changeQuantity('HP', -1)"
            style="min-width:34px"
            >-</button
          >
          <span class="item-count" data-brand="HP">0</span>
        </div>
      </div>

      <!-- Lenovo -->
      <div class="brand-card">
        <img src="images/lenovo.jpg" />
        <h3>Lenovo</h3>
        <p>IdeaPad, ThinkPad, Legion</p>
        <h4>‚Çπ35,000 ‚Äì ‚Çπ1,80,000</h4>
        <div class="card-footer">
          <button onclick="addToCart('Lenovo', 50000)">+</button>
          <button
            class="dec-btn"
            data-brand="Lenovo"
            onclick="changeQuantity('Lenovo', -1)"
            style="min-width:34px"
            >-</button
          >
          <span class="item-count" data-brand="Lenovo">0</span>
        </div>
      </div>

      <!-- ASUS -->
      <div class="brand-card">
        <img src="images/asus.jpg" />
        <h3>ASUS</h3>
        <p>VivoBook, ROG, TUF</p>
        <h4>‚Çπ40,000 ‚Äì ‚Çπ2,10,000</h4>
        <div class="card-footer">
          <button onclick="addToCart('ASUS', 58000)">+</button>
          <button
            class="dec-btn"
            data-brand="ASUS"
            onclick="changeQuantity('ASUS', -1)"
            style="min-width:34px"
            >-</button
          >
          <span class="item-count" data-brand="ASUS">0</span>
        </div>
      </div>

      <!-- Acer -->
      <div class="brand-card">
        <img src="images/acer.jpg" />
        <h3>Acer</h3>
        <p>Aspire, Nitro, Predator</p>
        <h4>‚Çπ30,000 ‚Äì ‚Çπ1,70,000</h4>
        <div class="card-footer">
          <button onclick="addToCart('Acer', 45000)">+</button>
          <button
            class="dec-btn"
            data-brand="Acer"
            onclick="changeQuantity('Acer', -1)"
            style="min-width:34px"
            >-</button
          >
          <span class="item-count" data-brand="Acer">0</span>
        </div>
      </div>

      <!-- MSI -->
      <div class="brand-card">
        <img src="images/msi.jpg" />
        <h3>MSI</h3>
        <p>Gaming & Creator Laptops</p>
        <h4>‚Çπ70,000 ‚Äì ‚Çπ3,00,000</h4>
        <div class="card-footer">
          <button onclick="addToCart('MSI', 90000)">+</button>
          <button
            class="dec-btn"
            data-brand="MSI"
            onclick="changeQuantity('MSI', -1)"
            style="min-width:34px"
            >-</button
          >
          <span class="item-count" data-brand="MSI">0</span>
        </div>
      </div>

      <!-- Samsung -->
      <div class="brand-card">
        <img src="images/samsung.jpg" />
        <h3>Samsung</h3>
        <p>Galaxy Book Series</p>
        <h4>‚Çπ50,000 ‚Äì ‚Çπ1,50,000</h4>
        <div class="card-footer">
          <button onclick="addToCart('Samsung', 65000)">+</button>
          <button
            class="dec-btn"
            data-brand="Samsung"
            onclick="changeQuantity('Samsung', -1)"
            style="min-width:34px"
            >-</button
          >
          <span class="item-count" data-brand="Samsung">0</span>
        </div>
      </div>

      <!-- Microsoft -->
      <div class="brand-card">
        <img src="images/microsoft.jpg" />
        <h3>Microsoft</h3>
        <p>Surface Laptops</p>
        <h4>‚Çπ75,000 ‚Äì ‚Çπ2,20,000</h4>
        <div class="card-footer">
          <button onclick="addToCart('Microsoft', 90000)">+</button>
          <button
            class="dec-btn"
            data-brand="Microsoft"
            onclick="changeQuantity('Microsoft', -1)"
            style="min-width:34px"
            >-</button
          >
          <span class="item-count" data-brand="Microsoft">0</span>
        </div>
      </div>

      <!-- LG -->
      <div class="brand-card">
        <img src="images/lg.jpg" />
        <h3>LG</h3>
        <p>LG Gram Ultra-light</p>
        <h4>‚Çπ80,000 ‚Äì ‚Çπ1,90,000</h4>
        <div class="card-footer">
          <button onclick="addToCart('LG', 95000)">+</button>
          <button
            class="dec-btn"
            data-brand="LG"
            onclick="changeQuantity('LG', -1)"
            style="min-width:34px"
            >-</button
          >
          <span class="item-count" data-brand="LG">0</span>
        </div>
      </div>

      <!-- Razer -->
      <div class="brand-card">
        <img src="images/razer.jpg" />
        <h3>Razer</h3>
        <p>High-end Gaming Laptops</p>
        <h4>‚Çπ1,50,000 ‚Äì ‚Çπ4,00,000</h4>
        <div class="card-footer">
          <button onclick="addToCart('Razer', 180000)">+</button>
          <button
            class="dec-btn"
            data-brand="Razer"
            onclick="changeQuantity('Razer', -1)"
            style="min-width:34px"
            >-</button
          >
          <span class="item-count" data-brand="Razer">0</span>
        </div>
      </div>
    </div>
  </section>

  <!-- Cart -->
  <div id="cartBox" class="cart-box">
    <h2>Your Cart</h2>
    <ul id="cartItems"></ul>
    <h3 id="totalPrice"></h3>
    <button onclick="placeOrder()">Place Order</button>
  </div>

  <footer>
    <p>¬© 2025 Global Laptop Showcase</p>
  </footer>

  <script src="cart.js"></script>
  <script src="script.js"></script>

  <script>
    // Toggle user popup visibility
    const userProfileBtn = document.getElementById("userProfileBtn");
    const userPopup = document.getElementById("userPopup");
    const userNameEl = document.getElementById("userName");
    const userEmailEl = document.getElementById("userEmail");
    const ordersPageBtn = document.getElementById("ordersPageBtn");
    const logoutBtn = document.getElementById("logoutBtn");

    userProfileBtn.addEventListener("click", () => {
      if (userPopup.style.display === "block") {
        userPopup.style.display = "none";
      } else {
        userPopup.style.display = "block";
      }
    });

    // Close popup if clicked outside
    document.addEventListener("click", (e) => {
      if (!userPopup.contains(e.target) && e.target !== userProfileBtn) {
        userPopup.style.display = "none";
      }
    });

    // Load user data from localStorage and display in popup
    function loadUserProfile() {
      try {
        const rawUser = localStorage.getItem("authUser");
        if (rawUser) {
          const user = JSON.parse(rawUser);
          userNameEl.textContent = user.name || user.email || "User";
          userEmailEl.textContent = user.email || "";
          ordersPageBtn.disabled = false;
          ordersPageBtn.style.backgroundColor = "#1976d2";
          ordersPageBtn.style.cursor = "pointer";
          if (logoutBtn) {
            logoutBtn.disabled = false;
            logoutBtn.style.backgroundColor = "#d32f2f";
            logoutBtn.style.cursor = "pointer";
          }
        } else {
          userNameEl.textContent = "Not signed in";
          userEmailEl.textContent = "";
          ordersPageBtn.disabled = true;
          ordersPageBtn.style.backgroundColor = "#aaa";
          ordersPageBtn.style.cursor = "default";
          if (logoutBtn) {
            logoutBtn.disabled = true;
            logoutBtn.style.backgroundColor = "#aaa";
            logoutBtn.style.cursor = "default";
          }
        }
      } catch {
        userNameEl.textContent = "Error loading user info";
        userEmailEl.textContent = "";
        ordersPageBtn.disabled = true;
        ordersPageBtn.style.backgroundColor = "#aaa";
        ordersPageBtn.style.cursor = "default";
        if (logoutBtn) {
          logoutBtn.disabled = true;
          logoutBtn.style.backgroundColor = "#aaa";
          logoutBtn.style.cursor = "default";
        }
      }
    }

    // Redirect to orders page when button clicked
    ordersPageBtn.addEventListener("click", () => {
      if (!ordersPageBtn.disabled) {
        window.location.href = "orders.html";
      }
    });

    // Logout handler: clear auth and redirect to login
    if (logoutBtn) {
      logoutBtn.addEventListener("click", () => {
        if (!logoutBtn.disabled) {
          localStorage.removeItem("authUser");
          localStorage.removeItem("token");
          userPopup.style.display = "none";
          loadUserProfile();
          window.location.href = "login.html";
        }
      });
    }

    loadUserProfile();
  </script>
</body>

</html>
